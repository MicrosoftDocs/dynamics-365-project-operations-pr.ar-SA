---
title: استخدام واجهات API لجدولة المشروع مع Power Automate
description: يوفر هذا الموضوع نموذج تدفق يستخدم واجهات برمجة تطبيقات (APIs) جدول المشروع.
author: ruhercul
ms.date: 01/26/2022
ms.topic: article
ms.reviewer: johnmichalak
ms.author: ruhercul
ms.openlocfilehash: 9708226b0955cfa6c405b9616c14765f9ebc21f7
ms.sourcegitcommit: c0792bd65d92db25e0e8864879a19c4b93efb10c
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 04/14/2022
ms.locfileid: "8597690"
---
# <a name="use-project-schedule-apis-with-power-automate"></a>استخدام واجهات API لجدولة المشروع مع Power Automate

_**ينطبق علي:** ‏‫Project Operations للسيناريوهات المستندة إلى مورد/غير مخزنة‬، ‏‫النشر الخفيف – التعامل مع الفواتير الأولية‬_

يصف هذا الموضوع نموذجًا للتدفق يوضح كيفية إنشاء خطة مشروع كاملة باستخدام Microsoft Power Automate وكيفية إنشاء مجموعة عمليات، وكيفية تحديث كيان. يوضح المثال كيفية إنشاء مشروع، وعضو فريق المشروع، ومجموعات العمليات، ومهام المشروع، وتعيينات الموارد. يوضح هذا الموضوع أيضًا كيفية تحديث كيان وتنفيذ مجموعة العمليات.

فيما يلي قائمة كاملة بالخطوات الموثقة في تدفق العينة في هذا الموضوع:

1. [إنشاء مشغّل PowerApps](#1)
2. [إنشاء مشروع](#2)
3. [تهيئة متغير لعضو الفريق](#3)
4. [إنشاء عضو فريق عام](#4)
5. [إنشاء مجموعة عمليات](#5)
6. [إنشاء مستودع مشروع](#6)
7. [تهيئة متغير لحالة الرابط](#7)
8. [تهيئة متغير لعدد المهام](#8)
9. [تهيئة متغير لمعرّف مهمة المشروع](#9)
10. [تنفيذ حتى](#10)
11. [تعيين مهمة مشروع](#11)
12. [إنشاء مهمة مشروع](#12)
13. [إنشاء تعيين مورد](#13)
14. [إنقاص متغير](#14)
15. [إعادة تسمية مهمة مشروع](#15)
16. [تشغيل مجموعة عمليات](#16)

## <a name="assumptions"></a>الافتراضات

يفترض هذا الموضوع أن لديك معرفة أساسية بمنصة Dataverse والتدفقات السحابية وواجهة برمجة تطبيقات جدول المشروع (API). لمزيد من المعلومات، انظر القسم [المراجع](#references) لاحقًا في هذا الموضوع.

## <a name="create-a-flow"></a>إنشاء تدفق

### <a name="select-an-environment"></a>تحديد بيئة

يمكنك إنشاء تدفق Power Automate في البيئة الخاصة بك.

1. انتقل إلى <https://flow.microsoft.com>، واستخدم بيانات اعتماد المسؤول لديك لتسجيل الدخول.
2. في الزاوية العلوية اليسرى، حدد **البيئات** .
3. في القائمة، حدد البيئة التي تم تثبيت Dynamics 365 Project Operations فيها.

### <a name="create-a-solution"></a>إنشاء حل

اتبع هذه الخطوات لإنشاء [تدفق متوافق مع الحل](/power-automate/overview-solution-flows). من خلال إنشاء تدفق متوافق مع الحل، يمكنك تصدير التدفق لاستخدامه لاحقًا بسهولة.

1. في جزء التنقل، حدد **الحلول**.
2. على صفحة **الحلول**، حدد **حل جديد**.
3. في مربع الحوار **حل جديد**، قم بتعيين الحقول المطلوبة، ثم حدد **إنشاء**.

## <a name="step-1-create-a-powerapps-trigger"></a><a id="1"></a>الخطوة 1: إنشاء مشغّل PowerApps

1. على صفحة **الحلول**، حدد الحل الذي قمت بإنشائه، ثم حدد **جديد**.
2. في الجزء الأيسر، قم بتحديد **عمليات سير عمل السحابة** \> **الأتمتة** \> **سير عمل السحابة** \> **فوري**.
3. في حقل **اسم سير العمل**، أدخل **جدولة سير عمل عرض واجهة برمجة التطبيقات**.
4. في قائمة **اختيار كيفية تشغيل هذا التدفق** حدد **Power Apps**. عند إنشاء مشغّل Power Apps، يكون المنطق يرجع إليك بصفتك المؤلف. في هذا الموضوع، اترك معلمات الإدخال فارغة لأغراض الاختبار.
5. حدد **إنشاء**.

## <a name="step-2-create-a-project"></a><a id="2"></a>الخطوة 2: إنشاء مشروع

اتبع هذه الخطوات لإنشاء مشروع عينة.

1. في سير العمل الذي أنشأته، حدد **خطوة جديدة**.

    ![إضافة خطوة جديدة.](media/newstep.png)

2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تنفيذ إجراء غير وارد**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.

    ![تحديد عملية.](media/chooseactiontab.png)

3. في الخطوة الجديدة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.

![إعادة تسميه خطوة.](media/renamestep.png)

4. أعد تسمية الخطوة **إنشاء مشروع**.
5. في الحقل **اسم الإجراء** حدد **msdyn\_CreateProjectV1**.
6. ضمن الحقل **msdyn\_subject** حدد **إضافة محتوى ديناميكي**.
7. في علامة تبويب **التعبير**، في حقل الدالة، أدخل **اسم المشروع - utcNow()**.
8. ثم حدد **موافق**.

## <a name="step-3-initialize-a-variable-for-the-team-member"></a><a id="3"></a>الخطوة 3: تهيئة متغير لعضو الفريق

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تهيئة متغير**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة الجديدة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **تهيئة عضو فريق**.
5. في حقل **الاسم**، أدخل **TeamMemberAction**.
6. في حقل **النوع**، حدد **سلسلة**.
7. في الحقل **قيمة**، أدخل **msdyn\_CreateTeamMemberV1**.

## <a name="step-4-create-a-generic-team-member"></a><a id="4"></a>الخطوة 4: إنشاء عضو فريق عام

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تنفيذ إجراء غير وارد**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة الجديدة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **إنشاء عضو فريق**.
5. بالنسبة إلى الحقل **اسم الإجراء** قم بتحديد **TeamMemberAction** في مربع الحوار **المحتوى الديناميكي**.
6. في حقل **معلمات الإجراء**، أدخل معلومات المعلمات التالية.

    ```
    {
        "TeamMember": {
            "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projectteam",
            "msdyn_projectteamid": "@{guid()}",
            "msdyn_project@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})",
            "msdyn_name": "ScheduleAPIDemoTM1"
        }
    } 
    ```

    فيما يلي شرح للمعلمات:

    - **\@\@odata.type** – اسم الكيان. على سبيل المثال، أدخل **"Microsoft.Dynamics.CRM.msdyn\_projectteam"**.
    - **msdyn\_projectteamid** – المفتاح الأساسي لمعرّف فريق المشروع. القيمة عبارة عن تعبير معرّف فريد عمومي (GUID).   يتم إنشاء المعرّف من علامة تبويب التعبير.

    - **msdyn\_project\@odata.bind** – معرّف المشروع الخاص بالمشروع المالك. ستكون القيمة محتوى ديناميكيًا يأتي من استجابة خطوة "إنشاء مشروع". تأكد من إدخال المسار الكامل وإضافة محتوى ديناميكي بين الأقواس. علامات الاقتباس مطلوبة. على سبيل المثال، أدخل **"/msdyn\_projects(ADD DYNAMIC CONTENT)"**.
    - **msdyn\_name** – اسم عضو الفريق. على سبيل المثال، أدخل **"ScheduleAPIDemoTM1"**.

## <a name="step-5-create-an-operation-set"></a><a id="5"></a>الخطوة 5: إنشاء مجموعة عمليات

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تنفيذ إجراء غير وارد**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة الجديدة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **إنشاء مجموعة العمليات**.
5. في الحقل **اسم الإجراء** حدد الإجراء المخصص **msdyn\_CreateOperationSetV1** Dataverse.
6. في حقل **الوصف**، أدخل **ScheduleAPIDemoOperationSet**.
7. في حقل **المشروع** أدخل **/msdyn\_projects(**.
8. في مربع الحوار **المحتوى الديناميكي** حدد **msdyn\_CreateProjectV1Response ProjectId**.
9. في حقل **المشروع** أدخل **)**.

## <a name="step-6-create-a-project-bucket"></a><a id="6"></a>الخطوة 6: إنشاء مستودع مشروع

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **إضافة صف جديد**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة الجديدة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **إنشاء مستودع**.
5. في الحقل **اسم الجدول** حدد **مستودع مشروع**.
6. في الحقل **الاسم** أدخل **ScheduleAPIDemoBucket1**.
7. بالنسبة للحقل **المشروع** حدد **msdyn\_CreateProjectV1Response ProjectId** في مربع الحوار **المحتوى الديناميكي**.

## <a name="step-7-initialize-a-variable-for-the-link-status"></a><a id="7"></a>الخطوة 7: تهيئة متغير لحالة الرابط

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تهيئة متغير**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة الجديدة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **Init linkstatus**.
5. في حقل **الاسم**، أدخل **linkstatus**.
6. في حقل **النوع**، حدد الخيار **عدد صحيح**.
7. في حقل **القيمة**، أدخل **192350000**.

## <a name="step-8-initialize-a-variable-for-the-number-of-tasks"></a><a id="8"></a>الخطوة 8: تهيئة متغير لعدد المهام

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تهيئة متغير**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة الجديدة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **تهيئة عدد من المهام**.
5. في حقل **الاسم**، أدخل **عدد المهام**.
6. في حقل **النوع**، حدد الخيار **عدد صحيح**.
7. في حقل **القيمة**، أدخل **5**.

## <a name="step-9-initialize-a-variable-for-the-project-task-id"></a><a id="9"></a>الخطوة 9: تهيئة متغير لمعرّف مهمة المشروع

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تهيئة متغير**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة الجديدة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **Init ProjectTaskID**.
5. في حقل **الاسم**، أدخل **عدد المهام**.
6. في حقل **النوع**، حدد **سلسلة**.
7. بالنسبة إلى حقل **القيمة** أدخل **guid()** في منشئ التعبير.

## <a name="step-10-do-until"></a><a id="10"></a>الخطوة 10: تنفيذ حتى

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تنفيذ حتى**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. قم بتعيين القيمة الأولى في العبارة الشرطية إلى متغير **عدد المهام** من مربع الحوار **المحتوى الديناميكي**.
4. قم بتعيين الشرط إلى **أقل من أو يساوي**.
5. قم بتعيين القيمة الثانية في العبارة الشرطية إلى **0**.

## <a name="step-11-set-a-project-task"></a><a id="11"></a>الخطوة 11: تعيين مهمة مشروع

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تعيين متغير**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة الجديدة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **تعيين مهمة مشروع**.
5. في حقل **الاسم** حدد **msdyn\_projecttaskid**.
6. بالنسبة إلى حقل **القيمة** أدخل **guid()** في منشئ التعبير.

## <a name="step-12-create-a-project-task"></a><a id="12"></a>الخطوة 12: إنشاء مهمة مشروع

اتبع هذه الخطوات لإنشاء مهمة مشروع لها معرّف فريد ينتمي إلى المشروع الحالي ومستودع المشروع الذي قمت بإنشائه.

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تنفيذ إجراء غير وارد**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **إنشاء مهمة مشروع**.
5. في الحقل **اسم الإجراء** حدد **msdyn\_PssCreateV1**.
6. في حقل **الكيان**، أدخل معلومات المعلمات التالية.

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projecttask",
        "msdyn_projecttaskid": "@{variables('msdyn_projecttaskid')}",
        "msdyn_project@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})",
        "msdyn_subject": "ScheduleAPIDemoTask1",
        "msdyn_projectbucket@odata.bind": "/msdyn_projectbuckets(@{outputs('Create_Project_Buckets')?['body/msdyn_projectbucketid']})",
        "msdyn_start": "@{addDays(utcNow(), 1)}",
        "msdyn_scheduledstart": "@{utcNow()}",
        "msdyn_scheduledend": "@{addDays(utcNow(), 5)}",
        "msdyn_LinkStatus": "192350000"
    }
    ```

    فيما يلي شرح للمعلمات:

    - **\@\@odata.type** – اسم الكيان. على سبيل المثال، أدخل **"Microsoft.Dynamics.CRM.msdyn\_projecttask"**.
    - **msdyn\_projecttaskid** – المعرّف الفريد للمهمة. يجب تعيين القيمة إلى متغير ديناميكي من **msdyn\_projecttaskid**.
    - **msdyn\_project\@odata.bind** – معرّف المشروع الخاص بالمشروع المالك. ستكون القيمة محتوى ديناميكيًا يأتي من استجابة خطوة "إنشاء مشروع". تأكد من إدخال المسار الكامل وإضافة محتوى ديناميكي بين الأقواس. علامات الاقتباس مطلوبة. على سبيل المثال، أدخل **"/msdyn\_projects(ADD DYNAMIC CONTENT)"**.
    - **msdyn\_subject** – أي اسم مهمة.
    - **msdyn\_projectbucket\@odata.bind** – مستودع المشروع الذي يحتوي على المهام. ستكون القيمة محتوى ديناميكيًا يأتي من استجابة خطوة "إنشاء مستودع". تأكد من إدخال المسار الكامل وإضافة محتوى ديناميكي بين الأقواس. علامات الاقتباس مطلوبة. على سبيل المثال، أدخل **"/msdyn\_projectbuckets(ADD DYNAMIC CONTENT)"**.
    - **msdynstart\_** – المحتوى الديناميكي لتاريخ البدء. على سبيل المثال، سيتم تمثيل يوم غد كـ **"addDays(utcNow(), 1)"**.
    - **msdyn\_scheduledstart** – تاريخ البدء المجدول. على سبيل المثال، سيتم تمثيل يوم غد كـ **"addDays(utcNow(), 1)"**.
    - **msdyn\_scheduleend** – تاريخ الانتهاء المجدول. حدد تاريخ في المستقبل. على سبيل المثال، حدد **"addDays(utcNow(), 5)"**.
    - **msdyn\_LinkStatus** – حالة الارتباط. على سبيل المثال، أدخل **"192350000"**.

7. بالنسبة للحقل **OperationSetId** حدد **msdyn\_CreateOperationSetV1Response** في مربع الحوار **المحتوى الديناميكي**.

## <a name="step-13-create-a-resource-assignment"></a><a id="13"></a>الخطوة 13: إنشاء تعيين مورد

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تنفيذ إجراء غير وارد**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **إنشاء تعيين**.
5. في الحقل **اسم الإجراء** حدد **msdyn\_PssCreateV1**.
6. في حقل **الكيان**، أدخل معلومات المعلمات التالية.

    ```
    {
        "@odata.type": "Microsoft.Dynamics.CRM.msdyn_resourceassignment",
        "msdyn_resourceassignmentid": "@{guid()}",
        "msdyn_name": "ScheduleAPIDemoAssign1",
        "msdyn_taskid@odata.bind": "/msdyn_projecttasks(@{variables('msdyn_projecttaskid')})",
        "msdyn_projectteamid@odata.bind": "/msdyn_projectteams(@{outputs('Create_Team_Member')?['body/TeamMemberId']})",
        "msdyn_projectid@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})"
    }
    ```

7. بالنسبة للحقل **OperationSetId** حدد **msdyn\_CreateOperationSetV1Response** في مربع الحوار **المحتوى الديناميكي**.

## <a name="step-14-decrement-a-variable"></a><a id="14"></a>الخطوة 14: إنقاص متغير

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **إنقاص متغير**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في حقل **الاسم**، حدد **عدد المهام**.
4. في حقل **القيمة**، أدخل **1**.

## <a name="step-15-rename-a-project-task"></a><a id="15"></a>الخطوة 15: إعادة تسمية مهمة مشروع

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تنفيذ إجراء غير وارد**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **إعادة تسمية مهمة مشروع**.
5. في الحقل **اسم الإجراء** حدد **msdyn\_PssUpdateV1**.
6. في حقل **الكيان**، أدخل معلومات المعلمات التالية.

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projecttask",
        "msdyn_projecttaskid": "@{variables('msdyn_projecttaskid')}",
        "msdyn_subject": "ScheduleDemoTask1-UpdatedName"
    }
    ```

7. بالنسبة للحقل **OperationSetId** حدد **msdyn\_CreateOperationSetV1Response** في مربع الحوار **المحتوى الديناميكي**.

## <a name="step-16-run-an-operation-set"></a><a id="16"></a>الخطوة 16: تشغيل مجموعة عمليات

1. في سير العمل، حدد **خطوة جديدة**.
2. في مربع الحوار **اختيار عملية**، في حقل البحث، أدخل **تنفيذ إجراء غير وارد**. ثم، من علامة تبويب **الإجراءات**، قم بتحديد العملية في قائمة النتائج.
3. في الخطوة، قم بتحديد علامة الحذف (**...**)، ثم حدد **إعادة تسمية**.
4. أعد تسمية الخطوة **تنفيذ مجموعة العمليات**.
5. في الحقل **اسم الإجراء** حدد **msdyn\_ExecuteOperationSetV1**.
6. بالنسبة للحقل **OperationSetId** حدد **msdyn\_CreateOperationSetV1Response OperationSetId** في مربع الحوار **المحتوى الديناميكي**.

## <a name="references"></a>المراجع

- [نظرة عامة على كيفية دمج التدفقات مع Dataverse - Power Automate](/power-automate/dataverse/overview?WT.mc_id=email)
- [استخدام واجهات برمجة التطبيقات لجدولة المشروع لتنفيذ عمليات مع كيانات الجدولة](schedule-api-preview.md)
- [نظرة عامة على تدفقات السحابة - Power Automate](/power-automate/overview-cloud?WT.mc_id=email)
- [نظرة عامة على التدفقات المتوافقة مع الحل - Power Automate](/power-automate/overview-solution-flows?WT.mc_id=email)
